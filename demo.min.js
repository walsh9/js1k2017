for(S=250,T=STAGE=0,W=a.width,M=Math,R=M.random,l='length',cls=()=>a.width=W,$=(d)=>{for(c.font=S+'px x',c.fillText(d,0,S),im=c.getImageData(0,10,S,S),cls(),gs=[],i=im.data[l];i-=4;)[rc,gc,bc]=im.data.slice(i,i+3),lum=848e-6*rc+.0028*gc+275e-6*bc,li=0|255*((116*M.pow(lum,1/3)-16)/100),gs[i/4]=M.min(255,M.max(0,li));for(gs.forEach((f,g)=>{opx=f,npx=128<f?255:0,qe=opx-npx,gs[g]=npx,[[1,0.44],[S-1,.19],[S,.31],[S+1,.06]].forEach((h)=>{g+h[0]<gs[l]&&(gs[g+h[0]]+=0|qe*h[1]+0.5),im.data[4*g]=im.data[4*g+1]=im.data[4*g+2]=opx})}),pt=[],i=gs[l];i--;)!gs[i]&&128<im.data[4*i+3]&&pt.push([i%S,0|i/S]);return pad(pt),pt},ct=(d,f)=>{return diff=d[l]-f[l],pad(0<diff?f:d,M.abs(diff)),d.map((g,h)=>[d[h][0],d[h][1],f[h][0],f[h][1]])},pad=(d,f)=>{for(;f--;)d.push(d[0|R()*d[l]]);d.map((g,h)=>d[(d[h]=d[j=0|h+R()*(d[l]-h)],j)]=g)},D=99,ani=(d,f)=>d+(f-d)*T/D,e=[...'\uD83D\uDD25\uD83D\uDC7E'].map($),t=[],x=e[l]-1;x--;)t.push(ct(e[x+1],e[x]));t.push(ct(e[0],e[e[l]-1])),setInterval(()=>{T++,STAGE<e[l]&&0<T?(cls(),document.bgColor='#cc8',c.fillStyle='#818',c.font=S+'px serif',t[STAGE].forEach((f)=>{c.fillRect(0|ani(f[0],f[2])+W/2-S/2,0|ani(f[1],f[3])+20,1,1)}),T>=D&&(T=-99,STAGE++)):STAGE>=e[l]&&(STAGE=0,T=-99)},32);
