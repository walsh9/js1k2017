for(S=200,STAGE=0,T=I=-50,P=99,W=a.width,H=a.height,M=Math,R=M.random,L='length',X=0|M.max(1,M.min(W,H)/S),console.log(X),V=(X-1)*W/2,cls=()=>c.clearRect(0,0,W,H),c.font='150px x',c.textAlign='center',A=a=>{for(c.fillText(a,W/2,150),im=c.getImageData(0,0,W,S),dt=im.data,cls(),gs=[],i=dt[L];i-=4;)gs[i/4]=0|M.min(255,M.max(0,.3*dt[i]+.6*dt[i+1]+.1*dt[i+2]));for(gs.forEach((d,f)=>{d&&255^d&&(np=128<d?255:0,qe=d-np,gs[f]=np,[[1,0.44],[W-1,.19],[W,.31],[W+1,.06]].forEach((g)=>{f+g[0]<gs[L]&&(gs[f+g[0]]+=0|qe*g[1])}))}),pt=[],i=gs[L];i--;)!gs[i]&&128<dt[4*i+3]&&pt.push([i%W,0|i/W]);return C(pt),pt},B=(a,d,f=a[L]-d[L])=>{return C(0<f?d:a,M.abs(f)),a.map((g,h)=>[a[h][0],a[h][1],d[h][0],d[h][1]])},C=(a,d)=>{for(;d--;)a.push(a[0|R()*a[L]]);a.map((f,g)=>a[(a[g]=a[j=0|g+R()*(a[L]-g)],j)]=f)},D=(a,d)=>0|a+(d-a)*T/P,e=[],k=47;k--;)e.push(A(String.fromCodePoint(127812+k)));for(C(e),t=[],x=e[L]-1;x--;)t.push(B(e[x+1],e[x]));t.push(B(e[0],e[e[L]-1])),setInterval(()=>{T++,STAGE<e[L]?(cls(),document.bgColor='#dde',c.fillStyle='#334',c.font=S+'px serif',t[STAGE].forEach((f)=>{0<T?c.fillRect(D(f[0],f[2])*X-V,D(f[1],f[3])*X,X,X):c.fillRect((0|f[0]+R()+.5)*X-V,(0|f[1]+R()+.5)*X,X,X)}),T>P&&(T=I,STAGE++)):(STAGE=0,T=I)},32);
