for(mx=my=T=S=200,W=a.width,H=a.height,M=Math,R=M.random,L='length',X=0|M.max(1,M.min(W,H)/S),V=(X-1)*W/2,cls=()=>c.clearRect(0,0,W,H),document.onmousemove=document.onmousedown=(d)=>{mx=d.pageX,my=d.pageY},c.font='150px x',c.textAlign='center',A=a=>{for(cls(),c.fillText(a,W/2,150),dt=c.getImageData(0,0,W,S).data,cls(),gs=[],i=dt[L];i-=4;)gs[i/4]=0|M.max(0,M.min(255,.3*dt[i]+.6*dt[i+1]+.1*dt[i+2]));for(gs.map((d,f)=>{d&&255^d&&(gs[f]=128<d?255:0,qe=d-gs[f],[[1,0.44],[W-1,.2],[W,.3],[W+1,.06]].map((g)=>{f+g[0]<gs[L]&&(gs[f+g[0]]+=0|qe*g[1],gs[f])}))}),pt=[],i=gs[L];i--;)!gs[i]&&128<dt[4*i+3]&&pt.push([i%W,0|i/W]);return C(pt),pt},B=(a,b,c=a[L]-b[L])=>{return C(0<c?b:a,M.abs(c)),a.map((d,f)=>[a[f][0],a[f][1],b[f][0],b[f][1]])},C=(a,b)=>{for(;b--;)a.push(a[0|R()*a[L]]);a.map((d,f)=>a[(a[f]=a[j=0|f+R()*(a[L]-f)],j)]=d)},D=(a,b)=>0|a+(b-a)*T/99,e=[],k=47;k--;)e.push(String.fromCodePoint(127812+k));C(e),setInterval(()=>{99<T&&(e.push(e.shift()),tf=B(A(e[0]),A(e[1])),T=-50),T+=2,cls(),a.style.background='hsl('+mx+',90%,90%)',c.fillStyle='hsl('+my+',90%,20%)',tf.map((f)=>{0<T?c.fillRect(D(f[0],f[2])*X-V,D(f[1],f[3])*X,X,X):c.fillRect((0|f[0]-R()+.5)*X-V,(0|f[1]-R()+.5)*X,X,X)})},64);
